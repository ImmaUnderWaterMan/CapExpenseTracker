<Window x:Class="CapExpenseTracker.AddEditExpenseWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="{Binding Title}" Height="450" Width="500"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="120"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Индикатор загрузки -->
        <Border Grid.Row="0" Grid.RowSpan="12" Grid.ColumnSpan="2" 
                Background="#80FFFFFF" 
                Panel.ZIndex="100"
                Visibility="Collapsed" x:Name="loadingOverlay">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <TextBlock Text="Загрузка..." FontSize="14" FontWeight="Bold" Margin="10"/>
                <ProgressBar IsIndeterminate="True" Width="100" Height="20"/>
            </StackPanel>
        </Border>

        <!-- Дата -->
        <TextBlock Grid.Row="0" Grid.Column="0" Text="Дата:" VerticalAlignment="Center" Margin="0,0,10,10"/>
        <DatePicker Grid.Row="0" Grid.Column="1" 
                    SelectedDate="{Binding DateDateTime, ValidatesOnDataErrors=True}"
                    Margin="0,0,0,10"/>
        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding [DateDateTime]}" Foreground="Red" FontSize="10" Margin="0,-5,0,10"/>

        <!-- Тип расхода -->
        <TextBlock Grid.Row="2" Grid.Column="0" Text="Тип расхода:" VerticalAlignment="Center" Margin="0,0,10,10"/>
        <ComboBox Grid.Row="2" Grid.Column="1" 
                  ItemsSource="{Binding ExpenseTypes}"
                  SelectedItem="{Binding TypeExpense, ValidatesOnDataErrors=True}"
                  Margin="0,0,0,10"/>
        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding [TypeExpense]}" Foreground="Red" FontSize="10" Margin="0,-5,0,10"/>

        <!-- Сумма -->
        <TextBlock Grid.Row="4" Grid.Column="0" Text="Сумма (руб):" VerticalAlignment="Center" Margin="0,0,10,10"/>
        <TextBox Grid.Row="4" Grid.Column="1" 
                 Text="{Binding Amount, ValidatesOnDataErrors=True}"
                 Margin="0,0,0,10"/>
        <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding [Amount]}" Foreground="Red" FontSize="10" Margin="0,-5,0,10"/>

        <!-- Пробег -->
        <TextBlock Grid.Row="6" Grid.Column="0" Text="Пробег (км):" VerticalAlignment="Center" Margin="0,0,10,10"/>
        <TextBox Grid.Row="6" Grid.Column="1" 
                 Text="{Binding CurrentRun, ValidatesOnDataErrors=True}"
                 Margin="0,0,0,10"/>
        <TextBlock Grid.Row="7" Grid.Column="1" Text="{Binding [CurrentRun]}" Foreground="Red" FontSize="10" Margin="0,-5,0,10"/>

        <!-- Периодичность -->
        <TextBlock Grid.Row="8" Grid.Column="0" Text="Периодичность:" VerticalAlignment="Center" Margin="0,0,10,10"/>
        <ComboBox Grid.Row="8" Grid.Column="1" 
                  ItemsSource="{Binding PeriodicityTypes}"
                  SelectedItem="{Binding Periodicity}"
                  Margin="0,0,0,10"/>

        <!-- Описание -->
        <TextBlock Grid.Row="9" Grid.Column="0" Text="Описание:" VerticalAlignment="Top" Margin="0,0,10,10"/>
        <TextBox Grid.Row="9" Grid.Column="1" 
                 Text="{Binding Comment}"
                 Grid.RowSpan="2"
                 Height="60" TextWrapping="Wrap" AcceptsReturn="True" 
                 VerticalScrollBarVisibility="Auto" Margin="0,0,0,10"/>

        <!-- Кнопки -->
        <StackPanel Grid.Row="11" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button x:Name="btnSave" Content="Сохранить" 
                    Command="{Binding SaveCommand}"
                    Width="80" Height="25" Margin="0,0,10,0"/>
            <Button x:Name="btnCancel" Content="Отмена" 
                    Command="{Binding CancelCommand}"
                    Width="80" Height="25"/>
        </StackPanel>
    </Grid>
</Window>